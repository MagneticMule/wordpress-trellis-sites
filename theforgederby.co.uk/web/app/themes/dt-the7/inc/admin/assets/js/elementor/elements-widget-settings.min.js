!function(a){a(function(){function b(a,b){return window.the7ElementorSettingsCache[a]||(window.the7ElementorSettingsCache[a]={}),void 0!==b?window.the7ElementorSettingsCache[a][b]:window.the7ElementorSettingsCache[a]}function c(a,b,c){window.the7ElementorSettingsCache[a]||(window.the7ElementorSettingsCache[a]={}),window.the7ElementorSettingsCache[a][b]=c}function d(a,c){var d=b(a,"terms"),e=[];return d[c]&&(e=d[c]),e}function e(a,c){var d=b(a,"taxonomies"),e=[];return d[c]&&(e=d[c]),e}function f(a,b,c){var d=window.Array.isArray(c)?c:[c];a.prop("disabled",!0),a.empty(),a.append(b.reduce(function(a,b,c){var e="";return-1!==d.indexOf(b.value)&&(e="selected"),a+'<option value="'+b.value+'"'+e+">"+b.label+"</option>"},"")),a.prop("disabled",!1)}function g(a,b,c){var g=a.attributes.widgetType;f(b,d(g,a.getSetting("taxonomy")),a.getSetting("terms")),f(c,e(g,a.getSetting("post_type")),a.getSetting("taxonomy"))}function h(b,c){b.attributes.panel&&-1!==["content_section","query_section"].indexOf(b.attributes.panel.activeSection)&&setTimeout(function(b,c){var g=c.$el.find("[data-setting='post_type']"),h=c.$el.find("[data-setting='taxonomy']"),i=c.$el.find("[data-setting='terms']");g.on("change",function(){var c=b.attributes.widgetType,d=e(c,a(this).val());d[0]&&(f(h,d,null),b.setSetting(d[0].value),h.trigger("change"))}),h.on("change",function(){var c=b.attributes.widgetType;i[0].options.length=0,f(i,d(c,a(this).val()),null),b.setSetting("terms",[])})},350,this.model,this.panel)}void 0===window.the7ElementorSettingsCache&&(window.the7ElementorSettingsCache={}),elementor.hooks.addAction("panel/open_editor/widget",function(i,j,k){var l=i.$el.find("[data-setting='post_type']"),m=i.$el.find("[data-setting='taxonomy']"),n=i.$el.find("[data-setting='terms']"),o=j.attributes.widgetType;if(b(o,"taxonomies")&&b(o,"terms"))g(j,n,m);else{var p={action:"the7_elements_get_widget_taxonomies",_wpnonce:window.the7ElementsWidget._wpnonce};a.post(window.the7ElementsWidget.ajaxurl,p).done(function(a){a||(a={}),c(o,"taxonomies",a.taxonomies),c(o,"terms",a.terms),g(j,n,m)})}l.on("change",function(){var b=j.attributes.widgetType,c=e(b,a(this).val());c[0]&&(f(m,c,null),j.setSetting(c[0].value),m.trigger("change"))}),m.on("change",function(){var b=j.attributes.widgetType;n[0].options.length=0,f(n,d(b,a(this).val()),null),j.setSetting("terms",[])}),elementor.channels.editor.off("change:editSettings",h).on("change:editSettings",h,{panel:i,model:j})}),elementor.on("preview:loaded",function(){elementor.addControlView("the7-query",elementor.modules.controls.Select2.extend({cache:null,isTitlesReceived:!1,getSelect2Placeholder:function(){return{id:"",text:"All"}},getControlValueByName:function(a){var b=this.model.get("group_prefix")+a;return this.container.settings.get(b)},getQueryDataDeprecated:function(){return{filter_type:this.model.get("filter_type"),object_type:this.model.get("object_type"),include_type:this.model.get("include_type"),query:this.model.get("query")}},getQueryData:function(){var a=elementorCommon.helpers.cloneObject(this.model.get("autocomplete"));return _.isEmpty(a.query)&&(a.query={}),"cpt_tax"===a.object&&(a.object="tax",(_.isEmpty(a.query)||_.isEmpty(a.query.post_type))&&(a.query.post_type=this.getControlValueByName("post_type"))),{autocomplete:a}},getSelect2DefaultOptions:function(){var a=this;return jQuery.extend(elementor.modules.controls.Select2.prototype.getSelect2DefaultOptions.apply(this,arguments),{ajax:{transport:function(b,c,d){var e=!_.isEmpty(a.model.get("filter_type")),f={},g="the7_panel_posts_control_filter_autocomplete";return e?(f=a.getQueryDataDeprecated(),g="the7_panel_posts_control_filter_autocomplete_deprecated"):f=a.getQueryData(),f.q=b.data.q,elementorCommon.ajax.addRequest(g,{data:f,success:c,error:d})},data:function(a){return{q:a.term,page:a.page}},cache:!0},escapeMarkup:function(a){return a},minimumInputLength:1})},getValueTitles:function(){var a=this,b={},c=!_.isEmpty(this.model.get("filter_type")),d=this.getControlValue(),e="the7_query_control_value_titles",f="autocomplete",g={};c?(f="filter_type",g=this.model.get(f).object,b.filter_type=g,b.object_type=a.model.get("object_type"),b.include_type=a.model.get("include_type"),b.unique_id=""+a.cid+g,e="the7_query_control_value_titles_deprecated"):(g=this.model.get(f).object,b.get_titles=a.getQueryData().autocomplete,b.unique_id=""+a.cid+g),d&&g&&(_.isArray(d)||(d=[d]),elementorCommon.ajax.loadObjects({action:e,ids:d,data:b,before:function(){a.addControlSpinner()},success:function(b){a.isTitlesReceived=!0,a.model.set("options",b),a.render()}}))},addControlSpinner:function(){this.ui.select.prop("disabled",!0),this.$el.find(".elementor-control-title").after('<span class="elementor-control-spinner">&nbsp;<i class="eicon-spinner eicon-animation-spin"></i>&nbsp;</span>')},onReady:function(){this.ui.select.select2(this.getSelect2Options()),this.isTitlesReceived||this.getValueTitles()}}))})})}(jQuery);